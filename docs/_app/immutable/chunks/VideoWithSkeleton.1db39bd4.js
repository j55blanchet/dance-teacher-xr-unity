import{S as x,i as $,s as ee,C as te,k as W,a as ie,l as z,m as H,h as F,c as ne,n as O,X as D,M as V,b as le,D as A,N as v,E as ae,F as oe,G as se,g as de,d as ue,T as fe,o as re,Z as he,w as L}from"./index.41f98ac2.js";import{a as ce}from"./mediapipe-utils.b2b00584.js";import{D as me,P as G}from"./vision_bundle.f4284cec.js";function _e(t){var l=getComputedStyle(t);return[t.clientWidth-parseFloat(l.paddingLeft)-parseFloat(l.paddingRight),t.clientHeight-parseFloat(l.paddingTop)-parseFloat(l.paddingBottom)]}function ge(t){let l,e,T=!1,S,r=!0,o,d,u,f,c,b;const m=t[23].default,s=te(m,t,t[22],null);function _(){cancelAnimationFrame(S),e.paused||(S=he(_),T=!0),t[25].call(e)}return{c(){l=W("div"),e=W("video"),s&&s.c(),o=ie(),d=W("div"),u=W("canvas"),this.h()},l(n){l=z(n,"DIV",{class:!0});var a=H(l);e=z(a,"VIDEO",{class:!0});var y=H(e);s&&s.l(y),y.forEach(F),o=ne(a),d=z(a,"DIV",{class:!0});var h=H(d);u=z(h,"CANVAS",{class:!0}),H(u).forEach(F),h.forEach(F),a.forEach(F),this.h()},h(){O(e,"class","svelte-1clxmx5"),(t[0]===void 0||t[8]===void 0)&&D(_),(t[1]===void 0||t[2]===void 0)&&D(()=>t[29].call(e)),t[7]===void 0&&D(()=>t[30].call(e)),t[8]===void 0&&D(()=>t[31].call(e)),V(e,"flipped",t[10]),O(u,"class","svelte-1clxmx5"),O(d,"class","overlay svelte-1clxmx5"),O(l,"class","videoWithSkeleton svelte-1clxmx5"),V(l,"fitToFlexbox",t[9])},m(n,a){le(n,l,a),A(l,e),s&&s.m(e,null),t[24](e),isNaN(t[3])||(e.playbackRate=t[3]),isNaN(t[5])||(e.volume=t[5]),e.muted=t[6],A(l,o),A(l,d),A(d,u),t[32](u),f=!0,c||(b=[v(e,"timeupdate",_),v(e,"ratechange",t[26]),v(e,"play",t[27]),v(e,"pause",t[27]),v(e,"volumechange",t[28]),v(e,"resize",t[29]),v(e,"durationchange",t[30]),v(e,"ended",t[31])],c=!0)},p(n,a){s&&s.p&&(!f||a[0]&4194304)&&ae(s,m,n,n[22],f?se(m,n[22],a,null):oe(n[22]),null),!T&&a[0]&1&&!isNaN(n[0])&&(e.currentTime=n[0]),T=!1,a[0]&8&&!isNaN(n[3])&&(e.playbackRate=n[3]),a[0]&16&&r!==(r=n[4])&&e[r?"pause":"play"](),a[0]&32&&!isNaN(n[5])&&(e.volume=n[5]),a[0]&64&&(e.muted=n[6]),(!f||a[0]&1024)&&V(e,"flipped",n[10]),(!f||a[0]&512)&&V(l,"fitToFlexbox",n[9])},i(n){f||(de(s,n),f=!0)},o(n){ue(s,n),f=!1},d(n){n&&F(l),s&&s.d(n),t[24](null),t[32](null),c=!1,fe(b)}}}function ve(t,l,e){let{$$slots:T={},$$scope:S}=l,r,o,d=null,u=null,{fitToFlexbox:f=!1}=l,{currentTime:c=0}=l,{playbackRate:b=1}=l,{paused:m=!0}=l,{volume:s=1}=l,{muted:_=!1}=l,{videoWidth:n=0}=l,{videoHeight:a=0}=l,{flipHorizontal:y=!1}=l,h=1,{duration:R=0}=l,{ended:k=!1}=l,{dance:I=null}=l,{poseData:E=null}=l,{drawSkeleton:P=!0}=l,g=0,w=0,C=1,N=null;function M(){o&&(d||e(16,d=o.getContext("2d")),d&&(u||(u=new me(d)),d.clearRect(0,0,o.width,o.height),!(!N||!P)&&(console.log("redrawing pose",N),u.drawConnectors(N,G.POSE_CONNECTIONS,{color:"white",lineWidth:4}),u.drawConnectors(N,G.POSE_CONNECTIONS,{color:"black",lineWidth:2}))))}re(()=>(new ResizeObserver(be=>{if(!r)return;const[Y,p]=_e(r);e(18,g=Y),e(19,w=p)}).observe(r),()=>{}));function U(i){L[i?"unshift":"push"](()=>{r=i,e(12,r)})}function q(){c=this.currentTime,k=this.ended,e(0,c),e(8,k)}function B(){b=this.playbackRate,e(3,b)}function X(){m=this.paused,e(4,m)}function Z(){s=this.volume,_=this.muted,e(5,s),e(6,_)}function j(){n=this.videoWidth,a=this.videoHeight,e(1,n),e(2,a)}function J(){R=this.duration,e(7,R)}function K(){k=this.ended,e(8,k)}function Q(i){L[i?"unshift":"push"](()=>{o=i,e(11,o),e(20,C),e(17,h),e(18,g),e(19,w),e(1,n),e(2,a)})}return t.$$set=i=>{"fitToFlexbox"in i&&e(9,f=i.fitToFlexbox),"currentTime"in i&&e(0,c=i.currentTime),"playbackRate"in i&&e(3,b=i.playbackRate),"paused"in i&&e(4,m=i.paused),"volume"in i&&e(5,s=i.volume),"muted"in i&&e(6,_=i.muted),"videoWidth"in i&&e(1,n=i.videoWidth),"videoHeight"in i&&e(2,a=i.videoHeight),"flipHorizontal"in i&&e(10,y=i.flipHorizontal),"duration"in i&&e(7,R=i.duration),"ended"in i&&e(8,k=i.ended),"dance"in i&&e(13,I=i.dance),"poseData"in i&&e(14,E=i.poseData),"drawSkeleton"in i&&e(15,P=i.drawSkeleton),"$$scope"in i&&e(22,S=i.$$scope)},t.$$.update=()=>{if(t.$$.dirty[0]&6&&n>0&&a>0&&e(17,h=n/a),t.$$.dirty[0]&786432&&g>0&&w>0&&e(20,C=g/w),t.$$.dirty[0]&1968128&&(o&&C>h?(e(11,o.width=g,o),e(11,o.height=w*h,o)):o&&C<=h&&(e(11,o.width=g,o),e(11,o.height=g/h,o))),t.$$.dirty[0]&16391){const i=(E==null?void 0:E.getReferencePoseAtTime(c))??null;console.log("New reference pose (pix landmarks)",i,n,a),e(21,N=i?ce(i,n,a):null)}t.$$.dirty[0]&2197504&&M()},[c,n,a,b,m,s,_,R,k,f,y,o,r,I,E,P,d,h,g,w,C,N,S,T,U,q,B,X,Z,j,J,K,Q]}class Te extends x{constructor(l){super(),$(this,l,ve,ge,ee,{fitToFlexbox:9,currentTime:0,playbackRate:3,paused:4,volume:5,muted:6,videoWidth:1,videoHeight:2,flipHorizontal:10,duration:7,ended:8,dance:13,poseData:14,drawSkeleton:15},null,[-1,-1])}}export{Te as V,_e as g};
