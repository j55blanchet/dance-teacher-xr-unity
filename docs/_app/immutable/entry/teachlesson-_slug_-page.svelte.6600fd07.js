import{S as te,i as se,s as le,k as g,a as A,l as p,m as k,h,c as S,n as _,L as q,p as G,b as H,G as f,M as ne,g as y,v as ie,d as V,f as ae,O as he,P as _e,y as re,z as oe,A as ce,B as ue,Q as me,q as W,r as X,R as Y,w as ve,T as ge,t as pe}from"../chunks/index.8d927e06.js";function Z(a,e,t){const l=a.slice();return l[10]=e[t],l}function x(a){let e;return{c(){e=g("span"),this.h()},l(t){e=p(t,"SPAN",{class:!0,style:!0});var l=k(e);l.forEach(h),this.h()},h(){_(e,"class","progress outlined svelte-1ict5iu"),G(e,"width",a[4]*100+"%")},m(t,l){H(t,e,l)},p(t,l){l&16&&G(e,"width",t[4]*100+"%")},d(t){t&&h(e)}}}function $(a){let e,t,l=a[2].children,n=[];for(let r=0;r<l.length;r+=1)n[r]=ee(Z(a,l,r));const c=r=>V(n[r],1,1,()=>{n[r]=null});return{c(){e=g("div");for(let r=0;r<n.length;r+=1)n[r].c();this.h()},l(r){e=p(r,"DIV",{class:!0});var i=k(e);for(let s=0;s<n.length;s+=1)n[s].l(i);i.forEach(h),this.h()},h(){_(e,"class","children svelte-1ict5iu")},m(r,i){H(r,e,i);for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(e,null);t=!0},p(r,i){if(i&15){l=r[2].children;let s;for(s=0;s<l.length;s+=1){const o=Z(r,l,s);n[s]?(n[s].p(o,i),y(n[s],1)):(n[s]=ee(o),n[s].c(),y(n[s],1),n[s].m(e,null))}for(ie(),s=l.length;s<n.length;s+=1)c(s);ae()}},i(r){if(!t){for(let i=0;i<l.length;i+=1)y(n[i]);t=!0}},o(r){n=n.filter(Boolean);for(let i=0;i<n.length;i+=1)V(n[i]);t=!1},d(r){r&&h(e),_e(n,r)}}}function ee(a){let e,t;return e=new de({props:{node:a[10],enableClick:a[0],currentTime:a[1],showProgressNodes:a[3]}}),e.$on("nodeClicked",a[7]),{c(){re(e.$$.fragment)},l(l){oe(e.$$.fragment,l)},m(l,n){ce(e,l,n),t=!0},p(l,n){const c={};n&4&&(c.node=l[10]),n&1&&(c.enableClick=l[0]),n&2&&(c.currentTime=l[1]),n&8&&(c.showProgressNodes=l[3]),e.$set(c)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){ue(e,l)}}}function be(a){let e,t,l,n,c,r,i=a[5]&&x(a),s=a[2].children.length>0&&$(a);return{c(){e=g("div"),t=g("a"),i&&i.c(),l=A(),s&&s.c(),this.h()},l(o){e=p(o,"DIV",{class:!0,style:!0});var u=k(e);t=p(u,"A",{class:!0});var T=k(t);i&&i.l(T),T.forEach(h),l=S(u),s&&s.l(u),u.forEach(h),this.h()},h(){_(t,"class","bar outlined svelte-1ict5iu"),q(t,"button",a[0]),q(t,"active",a[5]),_(e,"class","node svelte-1ict5iu"),G(e,"--node-duration",a[2].end_time-a[2].start_time)},m(o,u){H(o,e,u),f(e,t),i&&i.m(t,null),f(e,l),s&&s.m(e,null),n=!0,c||(r=ne(t,"click",a[6]),c=!0)},p(o,[u]){o[5]?i?i.p(o,u):(i=x(o),i.c(),i.m(t,null)):i&&(i.d(1),i=null),(!n||u&1)&&q(t,"button",o[0]),(!n||u&32)&&q(t,"active",o[5]),o[2].children.length>0?s?(s.p(o,u),u&4&&y(s,1)):(s=$(o),s.c(),y(s,1),s.m(e,null)):s&&(ie(),V(s,1,1,()=>{s=null}),ae()),(!n||u&4)&&G(e,"--node-duration",o[2].end_time-o[2].start_time)},i(o){n||(y(s),n=!0)},o(o){V(s),n=!1},d(o){o&&h(e),i&&i.d(),s&&s.d(),c=!1,r()}}}function ke(a,e,t){let{enableClick:l=!1}=e,{currentTime:n=0}=e,{node:c}=e,{showProgressNodes:r=[]}=e,i=0,s=!1;const o=he();function u(){l&&o("nodeClicked",c)}function T(d){me.call(this,a,d)}return a.$$set=d=>{"enableClick"in d&&t(0,l=d.enableClick),"currentTime"in d&&t(1,n=d.currentTime),"node"in d&&t(2,c=d.node),"showProgressNodes"in d&&t(3,r=d.showProgressNodes)},a.$$.update=()=>{a.$$.dirty&6&&t(4,i=(n-c.start_time)/(c.end_time-c.start_time)),a.$$.dirty&4&&c.id.split("-").findLast(()=>!0),a.$$.dirty&12&&t(5,s=r.includes(c))},[l,n,c,r,i,s,u,T]}class de extends te{constructor(e){super(),se(this,e,ke,be,le,{enableClick:0,currentTime:1,node:2,showProgressNodes:3})}}function Te(a){let e,t,l,n,c,r,i=a[4].title+"",s,o,u,T,d,N,E,v,D,w,P,O,B=!1,R,I,L,z;E=new de({props:{enableClick:!0,node:a[5].root,showProgressNodes:a[3],currentTime:a[1]}}),E.$on("nodeClicked",a[6]);function F(){cancelAnimationFrame(R),w.paused||(R=ge(F),B=!0),a[11].call(w)}return{c(){e=g("section"),t=g("nav"),l=g("a"),n=W("< Go Home"),c=A(),r=g("h1"),s=W(i),o=A(),u=g("div"),T=A(),d=g("div"),N=g("div"),re(E.$$.fragment),v=A(),D=g("div"),w=g("video"),P=g("source"),this.h()},l(m){e=p(m,"SECTION",{class:!0});var b=k(e);t=p(b,"NAV",{class:!0});var C=k(t);l=p(C,"A",{class:!0,href:!0});var M=k(l);n=X(M,"< Go Home"),M.forEach(h),c=S(C),r=p(C,"H1",{class:!0});var Q=k(r);s=X(Q,i),Q.forEach(h),o=S(C),u=p(C,"DIV",{});var fe=k(u);fe.forEach(h),C.forEach(h),T=S(b),d=p(b,"DIV",{class:!0});var U=k(d);N=p(U,"DIV",{class:!0});var j=k(N);oe(E.$$.fragment,j),j.forEach(h),U.forEach(h),v=S(b),D=p(b,"DIV",{class:!0});var J=k(D);w=p(J,"VIDEO",{class:!0});var K=k(w);P=p(K,"SOURCE",{src:!0,type:!0}),K.forEach(h),J.forEach(h),b.forEach(h),this.h()},h(){_(l,"class","button"),_(l,"href","/"),_(r,"class","title svelte-1ghftex"),_(t,"class","svelte-1ghftex"),_(N,"class","svelte-1ghftex"),_(d,"class","visual-tree svelte-1ghftex"),Y(P.src,O=a[2])||_(P,"src",O),_(P,"type","video/mp4"),_(w,"class","svelte-1ghftex"),_(D,"class","preview svelte-1ghftex"),_(e,"class","svelte-1ghftex")},m(m,b){H(m,e,b),f(e,t),f(t,l),f(l,n),f(t,c),f(t,r),f(r,s),f(t,o),f(t,u),f(e,T),f(e,d),f(d,N),ce(E,N,null),f(e,v),f(e,D),f(D,w),f(w,P),a[10](w),I=!0,L||(z=ne(w,"timeupdate",F),L=!0)},p(m,[b]){const C={};b&8&&(C.showProgressNodes=m[3]),b&2&&(C.currentTime=m[1]),E.$set(C),(!I||b&4&&!Y(P.src,O=m[2]))&&_(P,"src",O),!B&&b&2&&!isNaN(m[1])&&(w.currentTime=m[1]),B=!1},i(m){I||(y(E.$$.fragment,m),I=!0)},o(m){V(E.$$.fragment,m),I=!1},d(m){m&&h(e),ue(E),a[10](null),L=!1,z()}}}function Ee(a,e,t){let{data:l}=e;const n=l.dance,c=l.danceTree;let r="",i,s=1/0,o=0,u=null,T=[];async function d(v){console.log("node clicked",v.detail),t(9,u=v.detail),i&&(t(0,i.currentTime=v.detail.start_time,i),t(8,s=v.detail.end_time),await pe(),i.play())}function N(v){ve[v?"unshift":"push"](()=>{i=v,t(0,i)})}function E(){o=this.currentTime,t(1,o)}return a.$$set=v=>{"data"in v&&t(7,l=v.data)},a.$$.update=()=>{a.$$.dirty&512&&t(3,T=u!==null?[u]:[]),a.$$.dirty&259&&o>s&&i.pause()},t(2,r=`/bundle/videos/${n.clipPath}`),[i,o,r,T,n,c,d,l,s,u,N,E]}class Ce extends te{constructor(e){super(),se(this,e,Ee,Te,le,{data:7})}}export{Ce as default};
