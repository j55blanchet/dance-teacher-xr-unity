import{S as pe,i as be,s as ke,k as b,a as A,l as k,m as T,c as q,h,n as g,M as J,p as U,b as L,G as v,N as j,g as R,v as Te,d as M,f as Ee,J as Ne,K as Ie,e as oe,y as Pe,z as we,A as Ce,B as ye,L as Se,q as Z,O as Ae,r as $,T as ce,Q as ue,R as qe,w as Re,U as Le,V as Oe,t as Be}from"../chunks/index.53e576d4.js";function fe(n,t,e){const l=n.slice();return l[11]=t[e],l}function de(n,t,e){const l=n.slice();return l[14]=t[e],l}function _e(n){let t;return{c(){t=b("span"),this.h()},l(e){t=k(e,"SPAN",{class:!0,style:!0});var l=T(t);l.forEach(h),this.h()},h(){g(t,"class","progress outlined svelte-g9xqg2"),U(t,"width",n[5]*100+"%")},m(e,l){L(e,t,l)},p(e,l){l&32&&U(t,"width",e[5]*100+"%")},d(e){e&&h(t)}}}function he(n){let t;return{c(){t=b("span"),this.h()},l(e){t=k(e,"SPAN",{class:!0,style:!0});var l=T(t);l.forEach(h),this.h()},h(){g(t,"class","beat-line svelte-g9xqg2"),U(t,"left",(n[14]-n[2].start_time)/(n[2].end_time-n[2].start_time)*100+"%")},m(e,l){L(e,t,l)},p(e,l){l&20&&U(t,"left",(e[14]-e[2].start_time)/(e[2].end_time-e[2].start_time)*100+"%")},d(e){e&&h(t)}}}function me(n){let t,e=n[14]>n[2].start_time&&n[14]<n[2].end_time&&he(n);return{c(){e&&e.c(),t=oe()},l(l){e&&e.l(l),t=oe()},m(l,s){e&&e.m(l,s),L(l,t,s)},p(l,s){l[14]>l[2].start_time&&l[14]<l[2].end_time?e?e.p(l,s):(e=he(l),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(l){e&&e.d(l),l&&h(t)}}}function ve(n){let t,e,l=n[2].children,s=[];for(let i=0;i<l.length;i+=1)s[i]=ge(fe(n,l,i));const o=i=>M(s[i],1,1,()=>{s[i]=null});return{c(){t=b("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){t=k(i,"DIV",{class:!0});var u=T(t);for(let a=0;a<s.length;a+=1)s[a].l(u);u.forEach(h),this.h()},h(){g(t,"class","children svelte-g9xqg2")},m(i,u){L(i,t,u);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(t,null);e=!0},p(i,u){if(u&31){l=i[2].children;let a;for(a=0;a<l.length;a+=1){const m=fe(i,l,a);s[a]?(s[a].p(m,u),R(s[a],1)):(s[a]=ge(m),s[a].c(),R(s[a],1),s[a].m(t,null))}for(Te(),a=l.length;a<s.length;a+=1)o(a);Ee()}},i(i){if(!e){for(let u=0;u<l.length;u+=1)R(s[u]);e=!0}},o(i){s=s.filter(Boolean);for(let u=0;u<s.length;u+=1)M(s[u]);e=!1},d(i){i&&h(t),Ne(s,i)}}}function ge(n){let t,e;return t=new De({props:{node:n[11],enableClick:n[0],currentTime:n[1],showProgressNodes:n[3],beatTimes:n[4]}}),t.$on("nodeClicked",n[8]),{c(){Pe(t.$$.fragment)},l(l){we(t.$$.fragment,l)},m(l,s){Ce(t,l,s),e=!0},p(l,s){const o={};s&4&&(o.node=l[11]),s&1&&(o.enableClick=l[0]),s&2&&(o.currentTime=l[1]),s&8&&(o.showProgressNodes=l[3]),s&16&&(o.beatTimes=l[4]),t.$set(o)},i(l){e||(R(t.$$.fragment,l),e=!0)},o(l){M(t.$$.fragment,l),e=!1},d(l){ye(t,l)}}}function Ge(n){let t,e,l,s,o,i,u,a=n[6]&&_e(n),m=n[4],d=[];for(let r=0;r<m.length;r+=1)d[r]=me(de(n,m,r));let f=n[2].children.length>0&&ve(n);return{c(){t=b("div"),e=b("a"),a&&a.c(),l=A();for(let r=0;r<d.length;r+=1)d[r].c();s=A(),f&&f.c(),this.h()},l(r){t=k(r,"DIV",{class:!0,style:!0});var c=T(t);e=k(c,"A",{class:!0});var _=T(e);a&&a.l(_),l=q(_);for(let E=0;E<d.length;E+=1)d[E].l(_);_.forEach(h),s=q(c),f&&f.l(c),c.forEach(h),this.h()},h(){g(e,"class","bar outlined svelte-g9xqg2"),J(e,"button",n[0]),J(e,"active",n[6]),g(t,"class","node svelte-g9xqg2"),U(t,"--node-duration",n[2].end_time-n[2].start_time)},m(r,c){L(r,t,c),v(t,e),a&&a.m(e,null),v(e,l);for(let _=0;_<d.length;_+=1)d[_]&&d[_].m(e,null);v(t,s),f&&f.m(t,null),o=!0,i||(u=j(e,"click",n[7]),i=!0)},p(r,[c]){if(r[6]?a?a.p(r,c):(a=_e(r),a.c(),a.m(e,l)):a&&(a.d(1),a=null),c&20){m=r[4];let _;for(_=0;_<m.length;_+=1){const E=de(r,m,_);d[_]?d[_].p(E,c):(d[_]=me(E),d[_].c(),d[_].m(e,null))}for(;_<d.length;_+=1)d[_].d(1);d.length=m.length}(!o||c&1)&&J(e,"button",r[0]),(!o||c&64)&&J(e,"active",r[6]),r[2].children.length>0?f?(f.p(r,c),c&4&&R(f,1)):(f=ve(r),f.c(),R(f,1),f.m(t,null)):f&&(Te(),M(f,1,1,()=>{f=null}),Ee()),(!o||c&4)&&U(t,"--node-duration",r[2].end_time-r[2].start_time)},i(r){o||(R(f),o=!0)},o(r){M(f),o=!1},d(r){r&&h(t),a&&a.d(),Ne(d,r),f&&f.d(),i=!1,u()}}}function He(n,t,e){let{enableClick:l=!1}=t,{currentTime:s=0}=t,{node:o}=t,{showProgressNodes:i=[]}=t,{beatTimes:u=[]}=t,a=0,m=!1;const d=Ie();function f(){l&&d("nodeClicked",o)}function r(c){Se.call(this,n,c)}return n.$$set=c=>{"enableClick"in c&&e(0,l=c.enableClick),"currentTime"in c&&e(1,s=c.currentTime),"node"in c&&e(2,o=c.node),"showProgressNodes"in c&&e(3,i=c.showProgressNodes),"beatTimes"in c&&e(4,u=c.beatTimes)},n.$$.update=()=>{n.$$.dirty&6&&e(5,a=(s-o.start_time)/(o.end_time-o.start_time)),n.$$.dirty&4&&o.id.split("-").findLast(()=>!0),n.$$.dirty&12&&e(6,m=i.includes(o))},[l,s,o,i,u,a,m,f,r]}class De extends pe{constructor(t){super(),be(this,t,He,Ge,ke,{enableClick:0,currentTime:1,node:2,showProgressNodes:3,beatTimes:4})}}function Ue(n){let t,e,l,s,o,i,u,a,m,d=n[5].title+"",f,r,c,_,E,V,y,N,I,P,S,z,K=!1,x,Q,O,B,W,C,G,X,ee;document.title=t="Dance | "+n[5].title,y=new De({props:{enableClick:!0,node:n[6].root,showProgressNodes:n[4],currentTime:n[1],beatTimes:n[5].beatTimes||[]}}),y.$on("nodeClicked",n[7]);function te(){cancelAnimationFrame(x),P.paused||(x=Oe(te),K=!0),n[12].call(P)}return{c(){e=b("meta"),l=A(),s=b("section"),o=b("nav"),i=b("a"),u=Z("< Go Home"),a=A(),m=b("h1"),f=Z(d),r=A(),c=b("div"),_=A(),E=b("div"),V=b("div"),Pe(y.$$.fragment),N=A(),I=b("div"),P=b("video"),S=b("source"),Q=A(),O=b("div"),B=b("label"),W=Z(`Playback Speed
                `),C=b("input"),this.h()},l(p){const w=Ae("svelte-1jmxnxe",document.head);e=k(w,"META",{name:!0,content:!0}),w.forEach(h),l=q(p),s=k(p,"SECTION",{class:!0});var D=T(s);o=k(D,"NAV",{});var H=T(o);i=k(H,"A",{class:!0,href:!0});var le=T(i);u=$(le,"< Go Home"),le.forEach(h),a=q(H),m=k(H,"H1",{class:!0});var ne=T(m);f=$(ne,d),ne.forEach(h),r=q(H),c=k(H,"DIV",{});var Ve=T(c);Ve.forEach(h),H.forEach(h),_=q(D),E=k(D,"DIV",{class:!0});var se=T(E);V=k(se,"DIV",{class:!0});var ae=T(V);we(y.$$.fragment,ae),ae.forEach(h),se.forEach(h),N=q(D),I=k(D,"DIV",{class:!0});var F=T(I);P=k(F,"VIDEO",{class:!0});var ie=T(P);S=k(ie,"SOURCE",{src:!0,type:!0}),ie.forEach(h),Q=q(F),O=k(F,"DIV",{class:!0});var re=T(O);B=k(re,"LABEL",{});var Y=T(B);W=$(Y,`Playback Speed
                `),C=k(Y,"INPUT",{type:!0,name:!0,min:!0,max:!0,step:!0}),Y.forEach(h),re.forEach(h),F.forEach(h),D.forEach(h),this.h()},h(){g(e,"name","description"),g(e,"content","App for learning the dance: "+n[5].title),g(i,"class","button"),g(i,"href","/"),g(m,"class","title"),g(V,"class","svelte-vir7k5"),g(E,"class","visual-tree svelte-vir7k5"),ce(S.src,z=n[2])||g(S,"src",z),g(S,"type","video/mp4"),g(P,"class","svelte-vir7k5"),g(C,"type","range"),g(C,"name","playbackSpeed"),g(C,"min","0.5"),g(C,"max","2"),g(C,"step","0.1"),g(O,"class","controls"),g(I,"class","preview svelte-vir7k5"),g(s,"class","svelte-vir7k5")},m(p,w){v(document.head,e),L(p,l,w),L(p,s,w),v(s,o),v(o,i),v(i,u),v(o,a),v(o,m),v(m,f),v(o,r),v(o,c),v(s,_),v(s,E),v(E,V),Ce(y,V,null),v(s,N),v(s,I),v(I,P),v(P,S),n[11](P),isNaN(n[3])||(P.playbackRate=n[3]),v(I,Q),v(I,O),v(O,B),v(B,W),v(B,C),ue(C,n[3]),G=!0,X||(ee=[j(P,"timeupdate",te),j(P,"ratechange",n[13]),j(C,"change",n[14]),j(C,"input",n[14])],X=!0)},p(p,[w]){(!G||w&32)&&t!==(t="Dance | "+p[5].title)&&(document.title=t);const D={};w&16&&(D.showProgressNodes=p[4]),w&2&&(D.currentTime=p[1]),y.$set(D),(!G||w&4&&!ce(S.src,z=p[2]))&&g(S,"src",z),!K&&w&2&&!isNaN(p[1])&&(P.currentTime=p[1]),K=!1,w&8&&!isNaN(p[3])&&(P.playbackRate=p[3]),w&8&&ue(C,p[3])},i(p){G||(R(y.$$.fragment,p),G=!0)},o(p){M(y.$$.fragment,p),G=!1},d(p){h(e),p&&h(l),p&&h(s),ye(y),n[11](null),X=!1,qe(ee)}}}function Me(n,t,e){let{data:l}=t;const s=l.dance,o=l.danceTree;let i="",u,a=1/0,m=0,d=1,f=null,r=[];async function c(N){console.log("node clicked",N.detail),e(10,f=N.detail),u&&(e(0,u.currentTime=N.detail.start_time,u),e(9,a=N.detail.end_time),await Be(),u.play())}function _(N){Re[N?"unshift":"push"](()=>{u=N,e(0,u)})}function E(){m=this.currentTime,e(1,m)}function V(){d=this.playbackRate,e(3,d)}function y(){d=Le(this.value),e(3,d)}return n.$$set=N=>{"data"in N&&e(8,l=N.data)},n.$$.update=()=>{n.$$.dirty&1024&&e(4,r=f!==null?[f]:[]),n.$$.dirty&515&&m>a&&u.pause()},e(2,i=`/bundle/videos/${s.clipPath}`),[u,m,i,d,r,s,o,c,l,a,f,_,E,V,y]}class ze extends pe{constructor(t){super(),be(this,t,Me,Ue,ke,{data:8})}}export{ze as default};
