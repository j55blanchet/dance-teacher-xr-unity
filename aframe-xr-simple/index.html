<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component/dist/aframe-environment-component.min.js"></script>

    <style>
      html, body {
        height: 100%;
        width: 100%;
        margin: 0;
        padding: 0;
        position: relative;
      }
      a-scene {
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        margin: 0;
        padding: 0;
      }

      .page {
        position: absolute;
        margin: 0;
        padding: 1rem;
        width: 100%;
        height: 100%;
        box-sizing: border-box;

        font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
        pointer-events: none;
      }
    </style>
    <script src="avatarcontroller.js" defer></script>
  </head>
  <body>
    <a-scene background="color: #ECECEC" 
      embedded
      debug-controller="enabled: true;">
        <a-assets>
            <a-asset-item id="cityModel" src="low_poly_robot/scene.gltf"></a-asset-item>
        </a-assets>

        <a-entity environment="preset: forest;"></a-entity>

        <a-entity 
          id="teacherAvatar" 
          gltf-model="#cityModel"
          position="0 0 -3" 
          avatar-controller>
        </a-entity>
    </a-scene>

    <div class="page">
      <h1>Test</h1>
    </div>


    <script>
      const sceneEl = document.getElementById('scene');
      
      const lm1 = [0,0,0];
      const lm2 = [1, 1, 1];
      const vec = [lm1[0] - lm2[0], lm1[1] - lm2[1], lm1[2] - lm2[2]];
      
      const landmarkStart = lm1;
      const landmarkEnd = lm2;
      const x = 0;//(landmarkStart[0] + landmarkEnd[0]) / 2;
      const y = 0;//(landmarkStart[1] + landmarkEnd[1]) / 2;
      const z = 0;//(landmarkStart[2] + landmarkEnd[2]) / 2;
  
        
      var el1 = document.createElement('a-sphere');
      el1.setAttribute('color', 'blue');
      el1.setAttribute('position', `${lm1[0]} ${lm1[1]} ${lm1[2]}`);
      el1.setAttribute('radius', 0.11);
      sceneEl.appendChild(el1);
        
      var el2 = document.createElement('a-sphere');
      el2.setAttribute('color', 'red');
      el2.setAttribute('position', `${lm2[0]} ${lm2[1]} ${lm2[2]}`);
      el2.setAttribute('radius', 0.11);
      sceneEl.appendChild(el2);
        
      const vectorSquared = vec.map(e => Math.pow(e, 2));
      const vecSquaredSum = vectorSquared.reduce((a, b) => a + b, 0);
      const vectorLength = Math.sqrt(vecSquaredSum);
      
      function toDegrees(rads) {
        return rads * 180 / Math.PI;
      }
        
      const rotX = toDegrees(Math.atan2(vec[1], vec[2]));
      const rotY = 0.0;//toDegrees(Math.acos(vec[0] / vecLength));
      const rotZ = 0.0;
  
      function magnitude(x1,y1,x2,y2) {
        
      }
        
      var cyl = document.createElement('a-cylinder');
      cyl.setAttribute('color', 'gray');
      cyl.setAttribute('height', vectorLength * 2);
      cyl.setAttribute('radius', 0.04);
      cyl.setAttribute('position', `${x} ${y} ${z}`)
      cyl.setAttribute('rotation', `${rotX} ${rotY} ${rotZ}`)
      var cylX = document.createElement('a-sphere');
      cylX.setAttribute('color', 'darkred');
      cylX.setAttribute('position', `0 1 0`);
      cylX.setAttribute('radius', 0.11);
      cyl.appendChild(cylX)
        
      sceneEl.appendChild(cyl);
    </script>
  </body>
</html>